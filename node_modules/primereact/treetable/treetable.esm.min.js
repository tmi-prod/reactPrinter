import e,{Component as t}from"react";import{DomHandler as o,classNames as n,ObjectUtils as r,FilterUtils as i}from"primereact/utils";import{Paginator as l}from"primereact/paginator";import{InputText as s}from"primereact/inputtext";import a from"primereact/overlayeventbus";import{Ripple as p}from"primereact/ripple";function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function u(e){if(Array.isArray(e))return c(e)}function h(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function d(e,t){if(e){if("string"==typeof e)return c(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?c(e,t):void 0}}function f(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function y(e){return u(e)||h(e)||d(e)||f()}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function v(e,t,o){return t&&m(e.prototype,t),o&&m(e,o),e}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C(e,t){return(C=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function S(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&C(e,t)}function k(e){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function E(e,t){return!t||"object"!==k(t)&&"function"!=typeof t?b(e):t}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function x(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var M={exports:{}};function O(){}function R(){}R.resetWarningCache=O;M.exports=function(){function e(e,t,o,n,r,i){if("SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"!==i){var l=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}function t(){return e}e.isRequired=e;var o={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:R,resetWarningCache:O};return o.PropTypes=o,o}();var D=M.exports;function F(e,t){var o="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!o){if(Array.isArray(e)||(o=z(e))||t&&e&&"number"==typeof e.length){o&&(e=o);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,s=!1;return{s:function(){o=o.call(e)},n:function(){var e=o.next();return l=e.done,e},e:function(e){s=!0,i=e},f:function(){try{l||null==o.return||o.return()}finally{if(s)throw i}}}}function z(e,t){if(e){if("string"==typeof e)return T(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?T(e,t):void 0}}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function P(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var K=function(r){S(p,t);var i,l,a=(i=p,l=P(),function(){var e,t=w(i);if(l){var o=w(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return E(this,e)});function p(e){var t;return g(this,p),(t=a.call(this,e)).state={badgeVisible:!1},t.onFilterInput=t.onFilterInput.bind(b(t)),t}return v(p,[{key:"onHeaderClick",value:function(e,t){if(t.props.sortable){var n=e.target;(o.hasClass(n,"p-sortable-column")||o.hasClass(n,"p-column-title")||o.hasClass(n,"p-sortable-column-icon")||o.hasClass(n.parentElement,"p-sortable-column-icon"))&&(this.props.onSort({originalEvent:e,sortField:t.props.sortField||t.props.field,sortFunction:t.props.sortFunction,sortable:t.props.sortable}),o.clearSelection())}}},{key:"onHeaderMouseDown",value:function(e,t){this.props.reorderableColumns&&t.props.reorderable&&("INPUT"!==e.target.nodeName?e.currentTarget.draggable=!0:"INPUT"===e.target.nodeName&&(e.currentTarget.draggable=!1))}},{key:"onHeaderKeyDown",value:function(e,t){"Enter"===e.key&&(this.onHeaderClick(e,t),e.preventDefault())}},{key:"getMultiSortMetaDataIndex",value:function(e){if(this.props.multiSortMeta)for(var t=0;t<this.props.multiSortMeta.length;t++)if(this.props.multiSortMeta[t].field===e.props.field)return t;return-1}},{key:"onResizerMouseDown",value:function(e,t){this.props.resizableColumns&&this.props.onResizeStart&&this.props.onResizeStart({originalEvent:e,columnEl:e.target.parentElement,column:t})}},{key:"onDragStart",value:function(e,t){this.props.onDragStart&&this.props.onDragStart({originalEvent:e,column:t})}},{key:"onDragOver",value:function(e,t){this.props.onDragOver&&this.props.onDragOver({originalEvent:e,column:t})}},{key:"onDragLeave",value:function(e,t){this.props.onDragLeave&&this.props.onDragLeave({originalEvent:e,column:t})}},{key:"onDrop",value:function(e,t){this.props.onDrop&&this.props.onDrop({originalEvent:e,column:t})}},{key:"onFilterInput",value:function(e,t){var o=this;if(t.props.filter&&this.props.onFilter){this.filterTimeout&&clearTimeout(this.filterTimeout);var n=e.target.value;this.filterTimeout=setTimeout((function(){o.props.onFilter({value:n,field:t.props.field,matchMode:t.props.filterMatchMode}),o.filterTimeout=null}),this.props.filterDelay)}}},{key:"hasColumnFilter",value:function(e){if(e){var t,o=F(e);try{for(o.s();!(t=o.n()).done;){if(t.value.props.filter)return!0}}catch(e){o.e(e)}finally{o.f()}}return!1}},{key:"renderSortIcon",value:function(t,o,r){if(t.props.sortable){var i=n("p-sortable-column-icon","pi pi-fw",o?r<0?"pi-sort-amount-down":"pi-sort-amount-up-alt":"pi-sort-alt");return e.createElement("span",{className:i})}return null}},{key:"renderResizer",value:function(t){var o=this;return this.props.resizableColumns?e.createElement("span",{className:"p-column-resizer p-clickable",onMouseDown:function(e){return o.onResizerMouseDown(e,t)}}):null}},{key:"getAriaSort",value:function(e,t,o){if(e.props.sortable){var n=t?o<0?"pi-sort-down":"pi-sort-up":"pi-sort";return"pi-sort-down"===n?"descending":"pi-sort-up"===n?"ascending":"none"}return null}},{key:"renderSortBadge",value:function(t){return-1!==t&&this.state.badgeVisible?e.createElement("span",{className:"p-sortable-column-badge"},t+1):null}},{key:"renderHeaderCell",value:function(t,o){var r,i=this;if(t.props.filter&&o.renderFilter&&(r=t.props.filterElement||e.createElement(s,{onInput:function(e){return i.onFilterInput(e,t)},type:this.props.filterType,defaultValue:this.props.filters&&this.props.filters[t.props.field]?this.props.filters[t.props.field].value:null,className:"p-column-filter",placeholder:t.props.filterPlaceholder,maxLength:t.props.filterMaxLength})),o.filterOnly)return e.createElement("th",{key:t.props.columnKey||t.props.field||o.index,className:n("p-filter-column",t.props.filterHeaderClassName),style:t.props.filterHeaderStyle||t.props.style,rowSpan:t.props.rowSpan,colSpan:t.props.colSpan},r);var l=this.getMultiSortMetaDataIndex(t),a=-1!==l?this.props.multiSortMeta[l]:null,p=t.props.field===this.props.sortField,c=null!==a,u=t.props.sortable&&(p||c),h=0;p?h=this.props.sortOrder:c&&(h=a.order);var d=this.renderSortIcon(t,u,h),f=this.getAriaSort(t,u,h),y=this.renderSortBadge(l),g=n(t.props.headerClassName||t.props.className,{"p-sortable-column":t.props.sortable,"p-highlight":u,"p-resizable-column":this.props.resizableColumns}),m=this.renderResizer(t);return e.createElement("th",{key:t.columnKey||t.field||o.index,className:g,style:t.props.headerStyle||t.props.style,tabIndex:t.props.sortable?this.props.tabIndex:null,onClick:function(e){return i.onHeaderClick(e,t)},onMouseDown:function(e){return i.onHeaderMouseDown(e,t)},onKeyDown:function(e){return i.onHeaderKeyDown(e,t)},rowSpan:t.props.rowSpan,colSpan:t.props.colSpan,"aria-sort":f,onDragStart:function(e){return i.onDragStart(e,t)},onDragOver:function(e){return i.onDragOver(e,t)},onDragLeave:function(e){return i.onDragLeave(e,t)},onDrop:function(e){return i.onDrop(e,t)}},m,e.createElement("span",{className:"p-column-title"},t.props.header),d,y,r)}},{key:"renderHeaderRow",value:function(t,o){var n=this,r=e.Children.toArray(t.props.children).map((function(e,t){return n.renderHeaderCell(e,{index:t,filterOnly:!1,renderFilter:!0})}));return e.createElement("tr",{key:o},r)}},{key:"renderColumnGroup",value:function(){var t=this;return e.Children.toArray(this.props.columnGroup.props.children).map((function(e,o){return t.renderHeaderRow(e,o)}))}},{key:"renderColumns",value:function(t){var o=this;return t?this.hasColumnFilter(t)?e.createElement(e.Fragment,null,e.createElement("tr",null,t.map((function(e,t){return o.renderHeaderCell(e,{index:t,filterOnly:!1,renderFilter:!1})}))),e.createElement("tr",null,t.map((function(e,t){return o.renderHeaderCell(e,{index:t,filterOnly:!0,renderFilter:!0})})))):e.createElement("tr",null,t.map((function(e,t){return o.renderHeaderCell(e,{index:t,filterOnly:!1,renderFilter:!1})}))):null}},{key:"render",value:function(){var t=this.props.columnGroup?this.renderColumnGroup():this.renderColumns(this.props.columns);return e.createElement("thead",{className:"p-treetable-thead"},t)}}],[{key:"getDerivedStateFromProps",value:function(e,t){return{badgeVisible:e.multiSortMeta&&e.multiSortMeta.length>1}}}]),p}();function N(){return(N=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}function L(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var H=function(i){S(c,t);var l,s,p=(l=c,s=L(),function(){var e,t=w(l);if(s){var o=w(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return E(this,e)});function c(e){var t;return g(this,c),(t=p.call(this,e)).props.editor&&(t.state={}),t.onClick=t.onClick.bind(b(t)),t.onKeyDown=t.onKeyDown.bind(b(t)),t.onEditorFocus=t.onEditorFocus.bind(b(t)),t}return v(c,[{key:"onClick",value:function(){var e=this;this.props.editor&&!this.state.editing&&(this.props.selectOnEdit||!this.props.selectOnEdit&&this.props.selected)&&(this.selfClick=!0,this.setState({editing:!0},(function(){e.bindDocumentEditListener(),e.overlayEventListener=function(t){e.isOutsideClicked(t.target)||(e.selfClick=!0)},a.on("overlay-click",e.overlayEventListener)})))}},{key:"onKeyDown",value:function(e){13!==e.which&&9!==e.which||this.switchCellToViewMode(e)}},{key:"bindDocumentEditListener",value:function(){var e=this;this.documentEditListener||(this.documentEditListener=function(t){!e.selfClick&&e.isOutsideClicked(t.target)&&e.switchCellToViewMode(t),e.selfClick=!1},document.addEventListener("click",this.documentEditListener))}},{key:"isOutsideClicked",value:function(e){return this.container&&!(this.container.isSameNode(e)||this.container.contains(e))}},{key:"unbindDocumentEditListener",value:function(){this.documentEditListener&&(document.removeEventListener("click",this.documentEditListener),this.documentEditListener=null,this.selfClick=!1)}},{key:"closeCell",value:function(){var e=this;setTimeout((function(){e.setState({editing:!1},(function(){e.unbindDocumentEditListener(),a.off("overlay-click",e.overlayEventListener),e.overlayEventListener=null}))}),1)}},{key:"onEditorFocus",value:function(e){this.onClick(e)}},{key:"switchCellToViewMode",value:function(e){this.props.editorValidator?this.props.editorValidator({originalEvent:e,columnProps:this.props})&&this.closeCell():this.closeCell()}},{key:"componentDidUpdate",value:function(){var e=this;if(this.container&&this.props.editor)if(clearTimeout(this.tabindexTimeout),this.state&&this.state.editing){var t=o.findSingle(this.container,"input");t&&document.activeElement!==t&&!t.hasAttribute("data-isCellEditing")&&(t.setAttribute("data-isCellEditing",!0),t.focus()),this.keyHelper.tabIndex=-1}else this.tabindexTimeout=setTimeout((function(){e.keyHelper&&e.keyHelper.setAttribute("tabindex",0)}),50)}},{key:"componentWillUnmount",value:function(){this.unbindDocumentEditListener(),this.overlayEventListener&&(a.off("overlay-click",this.overlayEventListener),this.overlayEventListener=null)}},{key:"render",value:function(){var t,o=this,i=n(this.props.bodyClassName||this.props.className,{"p-editable-column":this.props.editor,"p-cell-editing":!!this.props.editor&&this.state.editing}),l=this.props.bodyStyle||this.props.style;if(this.state&&this.state.editing){if(!this.props.editor)throw new Error("Editor is not found on column.");t=this.props.editor(this.props)}else t=this.props.body?this.props.body(this.props.node,this.props):r.resolveFieldData(this.props.node.data,this.props.field);return e.createElement("td",{ref:function(e){return o.container=e},className:i,style:l,onClick:this.onClick,onKeyDown:this.onKeyDown},this.props.children,this.props.editor&&e.createElement("a",{tabIndex:0,ref:function(e){o.keyHelper=e},className:"p-cell-editor-key-helper p-hidden-accessible",onFocus:this.onEditorFocus},e.createElement("span",null)),t)}}]),c}();function U(e,t){var o="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!o){if(Array.isArray(e)||(o=I(e))||t&&e&&"number"==typeof e.length){o&&(e=o);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,s=!1;return{s:function(){o=o.call(e)},n:function(){var e=o.next();return l=e.done,e},e:function(e){s=!0,i=e},f:function(){try{l||null==o.return||o.return()}finally{if(s)throw i}}}}function I(e,t){if(e){if("string"==typeof e)return B(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?B(e,t):void 0}}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function j(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function A(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?j(Object(o),!0).forEach((function(t){x(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):j(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function G(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var W=function(r){S(a,t);var i,l,s=(i=a,l=G(),function(){var e,t=w(i);if(l){var o=w(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return E(this,e)});function a(e){var t;return g(this,a),(t=s.call(this,e)).onTogglerClick=t.onTogglerClick.bind(b(t)),t.onClick=t.onClick.bind(b(t)),t.onTouchEnd=t.onTouchEnd.bind(b(t)),t.propagateUp=t.propagateUp.bind(b(t)),t.onCheckboxChange=t.onCheckboxChange.bind(b(t)),t.onCheckboxFocus=t.onCheckboxFocus.bind(b(t)),t.onCheckboxBlur=t.onCheckboxBlur.bind(b(t)),t.onRightClick=t.onRightClick.bind(b(t)),t.onKeyDown=t.onKeyDown.bind(b(t)),t}return v(a,[{key:"isLeaf",value:function(){return!1!==this.props.node.leaf&&!(this.props.node.children&&this.props.node.children.length)}},{key:"onTogglerClick",value:function(e){this.isExpanded()?this.collapse(e):this.expand(e),e.preventDefault(),e.stopPropagation()}},{key:"expand",value:function(e){var t=this.props.expandedKeys?A({},this.props.expandedKeys):{};t[this.props.node.key]=!0,this.props.onToggle({originalEvent:e,value:t}),this.invokeToggleEvents(e,!0)}},{key:"collapse",value:function(e){var t=A({},this.props.expandedKeys);delete t[this.props.node.key],this.props.onToggle({originalEvent:e,value:t}),this.invokeToggleEvents(e,!1)}},{key:"invokeToggleEvents",value:function(e,t){t?this.props.onExpand&&this.props.onExpand({originalEvent:e,node:this.props.node}):this.props.onCollapse&&this.props.onCollapse({originalEvent:e,node:this.props.node})}},{key:"onClick",value:function(e){this.props.onRowClick&&this.props.onRowClick({originalEvent:e,node:this.props.node});var t=e.target.nodeName;if(!("INPUT"===t||"BUTTON"===t||"A"===t||o.hasClass(e.target,"p-clickable")||o.hasClass(e.target,"p-treetable-toggler")||o.hasClass(e.target.parentElement,"p-treetable-toggler"))){if((this.isSingleSelectionMode()||this.isMultipleSelectionMode())&&!1!==this.props.node.selectable){var n,r=this.isSelected();if(!this.nodeTouched&&this.props.metaKeySelection){var i=e.metaKey||e.ctrlKey;r&&i?(this.isSingleSelectionMode()?n=null:delete(n=A({},this.props.selectionKeys))[this.props.node.key],this.props.onUnselect&&this.props.onUnselect({originalEvent:e,node:this.props.node})):(this.isSingleSelectionMode()?n=this.props.node.key:this.isMultipleSelectionMode()&&((n=i&&this.props.selectionKeys?A({},this.props.selectionKeys):{})[this.props.node.key]=!0),this.props.onSelect&&this.props.onSelect({originalEvent:e,node:this.props.node}))}else this.isSingleSelectionMode()?r?(n=null,this.props.onUnselect&&this.props.onUnselect({originalEvent:e,node:this.props.node})):(n=this.props.node.key,this.props.onSelect&&this.props.onSelect({originalEvent:e,node:this.props.node})):r?(delete(n=A({},this.props.selectionKeys))[this.props.node.key],this.props.onUnselect&&this.props.onUnselect({originalEvent:e,node:this.props.node})):((n=this.props.selectionKeys?A({},this.props.selectionKeys):{})[this.props.node.key]=!0,this.props.onSelect&&this.props.onSelect({originalEvent:e,node:this.props.node}));this.props.onSelectionChange&&this.props.onSelectionChange({originalEvent:e,value:n})}this.nodeTouched=!1}}},{key:"onTouchEnd",value:function(){this.nodeTouched=!0}},{key:"onCheckboxChange",value:function(e){var t=this.isChecked(),n=this.props.selectionKeys?A({},this.props.selectionKeys):{};t?(this.props.propagateSelectionDown?this.propagateDown(this.props.node,!1,n):delete n[this.props.node.key],this.props.propagateSelectionUp&&this.props.onPropagateUp&&this.props.onPropagateUp({originalEvent:e,check:!1,selectionKeys:n}),this.props.onUnselect&&this.props.onUnselect({originalEvent:e,node:this.props.node})):(this.props.propagateSelectionDown?this.propagateDown(this.props.node,!0,n):n[this.props.node.key]={checked:!0},this.props.propagateSelectionUp&&this.props.onPropagateUp&&this.props.onPropagateUp({originalEvent:e,check:!0,selectionKeys:n}),this.props.onSelect&&this.props.onSelect({originalEvent:e,node:this.props.node})),this.props.onSelectionChange&&this.props.onSelectionChange({originalEvent:e,value:n}),o.clearSelection()}},{key:"onCheckboxFocus",value:function(){o.addClass(this.checkboxBox,"p-focus")}},{key:"onCheckboxBlur",value:function(){o.removeClass(this.checkboxBox,"p-focus")}},{key:"propagateUp",value:function(e){var t,o=e.check,n=e.selectionKeys,r=0,i=!1,l=U(this.props.node.children);try{for(l.s();!(t=l.n()).done;){var s=t.value;n[s.key]&&n[s.key].checked?r++:n[s.key]&&n[s.key].partialChecked&&(i=!0)}}catch(e){l.e(e)}finally{l.f()}o&&r===this.props.node.children.length?n[this.props.node.key]={checked:!0,partialChecked:!1}:(o||delete n[this.props.node.key],n[this.props.node.key]=i||r>0&&r!==this.props.node.children.length?{checked:!1,partialChecked:!0}:{checked:!1,partialChecked:!1}),this.props.propagateSelectionUp&&this.props.onPropagateUp&&this.props.onPropagateUp(e)}},{key:"propagateDown",value:function(e,t,o){if(t?o[e.key]={checked:!0,partialChecked:!1}:delete o[e.key],e.children&&e.children.length)for(var n=0;n<e.children.length;n++)this.propagateDown(e.children[n],t,o)}},{key:"onRightClick",value:function(e){o.clearSelection(),this.props.onContextMenuSelectionChange&&this.props.onContextMenuSelectionChange({originalEvent:e,value:this.props.node.key}),this.props.onContextMenu&&this.props.onContextMenu({originalEvent:e,node:this.props.node})}},{key:"onKeyDown",value:function(e){if(e.target===this.container){var t=e.currentTarget;switch(e.which){case 40:var o=t.nextElementSibling;o&&o.focus(),e.preventDefault();break;case 38:var n=t.previousElementSibling;n&&n.focus(),e.preventDefault();break;case 39:this.isExpanded()||this.expand(e),e.preventDefault();break;case 37:this.isExpanded()&&this.collapse(e),e.preventDefault();break;case 13:this.onClick(e),e.preventDefault()}}}},{key:"isSingleSelectionMode",value:function(){return this.props.selectionMode&&"single"===this.props.selectionMode}},{key:"isMultipleSelectionMode",value:function(){return this.props.selectionMode&&"multiple"===this.props.selectionMode}},{key:"isExpanded",value:function(){return!!this.props.expandedKeys&&void 0!==this.props.expandedKeys[this.props.node.key]}},{key:"isSelected",value:function(){return!("single"!==this.props.selectionMode&&"multiple"!==this.props.selectionMode||!this.props.selectionKeys)&&("single"===this.props.selectionMode?this.props.selectionKeys===this.props.node.key:void 0!==this.props.selectionKeys[this.props.node.key])}},{key:"isChecked",value:function(){return!!this.props.selectionKeys&&(this.props.selectionKeys[this.props.node.key]&&this.props.selectionKeys[this.props.node.key].checked)}},{key:"isPartialChecked",value:function(){return!!this.props.selectionKeys&&(this.props.selectionKeys[this.props.node.key]&&this.props.selectionKeys[this.props.node.key].partialChecked)}},{key:"renderToggler",value:function(){var t=this.isExpanded(),o=n('"p-treetable-toggler-icon pi pi-fw',{"pi-chevron-right":!t,"pi-chevron-down":t});return e.createElement("button",{type:"button",className:"p-treetable-toggler p-link p-unselectable-text",onClick:this.onTogglerClick,tabIndex:-1,style:{marginLeft:16*this.props.level+"px",visibility:!1===this.props.node.leaf||this.props.node.children&&this.props.node.children.length?"visible":"hidden"}},e.createElement("i",{className:o}),e.createElement(p,null))}},{key:"renderCheckbox",value:function(){var t=this;if("checkbox"===this.props.selectionMode&&!1!==this.props.node.selectable){var o=this.isChecked(),r=this.isPartialChecked(),i=n("p-checkbox-box",{"p-highlight":o,"p-indeterminate":r}),l=n("p-checkbox-icon p-c",{"pi pi-check":o,"pi pi-minus":r});return e.createElement("div",{className:"p-checkbox p-treetable-checkbox p-component",onClick:this.onCheckboxChange,role:"checkbox","aria-checked":o},e.createElement("div",{className:"p-hidden-accessible"},e.createElement("input",{type:"checkbox",onFocus:this.onCheckboxFocus,onBlur:this.onCheckboxBlur})),e.createElement("div",{className:i,ref:function(e){return t.checkboxBox=e}},e.createElement("span",{className:l})))}return null}},{key:"renderCell",value:function(t){var o,n;return t.props.expander&&(o=this.renderToggler(),n=this.renderCheckbox()),e.createElement(H,N({key:t.props.columnKey||t.props.field},t.props,{selectOnEdit:this.props.selectOnEdit,selected:this.isSelected(),node:this.props.node,rowIndex:this.props.rowIndex}),o,n)}},{key:"renderChildren",value:function(){var t=this;return this.isExpanded()&&this.props.node.children?this.props.node.children.map((function(o,n){return e.createElement(a,{key:o.key||JSON.stringify(o.data),level:t.props.level+1,rowIndex:t.props.rowIndex+"_"+n,node:o,columns:t.props.columns,expandedKeys:t.props.expandedKeys,selectOnEdit:t.props.selectOnEdit,onToggle:t.props.onToggle,onExpand:t.props.onExpand,onCollapse:t.props.onCollapse,selectionMode:t.props.selectionMode,selectionKeys:t.props.selectionKeys,onSelectionChange:t.props.onSelectionChange,metaKeySelection:t.props.metaKeySelection,onRowClick:t.props.onRowClick,onSelect:t.props.onSelect,onUnselect:t.props.onUnselect,propagateSelectionUp:t.props.propagateSelectionUp,propagateSelectionDown:t.props.propagateSelectionDown,onPropagateUp:t.propagateUp,rowClassName:t.props.rowClassName,contextMenuSelectionKey:t.props.contextMenuSelectionKey,onContextMenuSelectionChange:t.props.onContextMenuSelectionChange,onContextMenu:t.props.onContextMenu})})):null}},{key:"render",value:function(){var t=this,o=this.props.columns.map((function(e){return t.renderCell(e)})),r=this.renderChildren(),i={"p-highlight":this.isSelected(),"p-highlight-contextmenu":this.props.contextMenuSelectionKey&&this.props.contextMenuSelectionKey===this.props.node.key};if(this.props.rowClassName){var l=this.props.rowClassName(this.props.node);i=A(A({},i),l)}return i=n(i,this.props.node.className),e.createElement(e.Fragment,null,e.createElement("tr",{ref:function(e){return t.container=e},tabIndex:0,className:i,style:this.props.node.style,onClick:this.onClick,onTouchEnd:this.onTouchEnd,onContextMenu:this.onRightClick,onKeyDown:this.onKeyDown},o),r)}}]),a}();function V(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}x(W,"defaultProps",{node:null,level:null,columns:null,expandedKeys:null,contextMenuSelectionKey:null,selectionMode:null,selectionKeys:null,metaKeySelection:!0,propagateSelectionUp:!0,propagateSelectionDown:!0,rowClassName:null,onExpand:null,onCollapse:null,onToggle:null,onRowClick:null,onSelect:null,onUnselect:null,onSelectionChange:null,onPropagateUp:null,onContextMenuSelectionChange:null,onContextMenu:null}),x(W,"propTypes",{node:D.any,level:D.number,columns:D.array,expandedKeys:D.object,contextMenuSelectionKey:D.any,selectionMode:D.string,selectionKeys:D.any,metaKeySelection:D.bool,propagateSelectionUp:D.bool,propagateSelectionDown:D.bool,rowClassName:D.func,onExpand:D.func,onCollapse:D.func,onToggle:D.func,onRowClick:D.func,onSelect:D.func,onUnselect:D.func,onSelectionChange:D.func,onPropagateUp:D.func,onContextMenuSelectionChange:D.func,onContextMenu:D.func});var _=function(o){S(l,t);var n,r,i=(n=l,r=V(),function(){var e,t=w(n);if(r){var o=w(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return E(this,e)});function l(){return g(this,l),i.apply(this,arguments)}return v(l,[{key:"createRow",value:function(t,o){return e.createElement(W,{key:t.key||JSON.stringify(t.data),level:0,rowIndex:o,selectOnEdit:this.props.selectOnEdit,node:t,columns:this.props.columns,expandedKeys:this.props.expandedKeys,onToggle:this.props.onToggle,onExpand:this.props.onExpand,onCollapse:this.props.onCollapse,selectionMode:this.props.selectionMode,selectionKeys:this.props.selectionKeys,onSelectionChange:this.props.onSelectionChange,metaKeySelection:this.props.metaKeySelection,onRowClick:this.props.onRowClick,onSelect:this.props.onSelect,onUnselect:this.props.onUnselect,propagateSelectionUp:this.props.propagateSelectionUp,propagateSelectionDown:this.props.propagateSelectionDown,rowClassName:this.props.rowClassName,contextMenuSelectionKey:this.props.contextMenuSelectionKey,onContextMenuSelectionChange:this.props.onContextMenuSelectionChange,onContextMenu:this.props.onContextMenu})}},{key:"renderRows",value:function(){var e=this;if(this.props.paginator&&!this.props.lazy){for(var t=this.props.first||0,o=t+(this.props.rows||0),n=[],r=t;r<o;r++){if(!this.props.value[r])break;n.push(this.createRow(this.props.value[r]))}return n}return this.props.value.map((function(t,o){return e.createRow(t,o)}))}},{key:"renderEmptyMessage",value:function(){return this.props.loading?null:e.createElement("tr",null,e.createElement("td",{className:"p-treetable-emptymessage",colSpan:this.props.columns?this.props.columns.length:null},this.props.emptyMessage))}},{key:"render",value:function(){var t=this.props.value&&this.props.value.length?this.renderRows():this.renderEmptyMessage();return e.createElement("tbody",{className:"p-treetable-tbody"},t)}}]),l}();function X(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}x(_,"defaultProps",{value:null,columns:null,expandedKeys:null,contextMenuSelectionKey:null,paginator:!1,first:null,rows:null,selectionMode:null,selectionKeys:null,metaKeySelection:!0,propagateSelectionUp:!0,propagateSelectionDown:!0,lazy:!1,rowClassName:null,emptyMessage:"No records found",loading:!1,onExpand:null,onCollapse:null,onToggle:null,onRowClick:null,onSelect:null,onUnselect:null,onSelectionChange:null,onContextMenuSelectionChange:null,onContextMenu:null}),x(_,"propTypes",{value:D.array,columns:D.array,expandedKeys:D.object,contextMenuSelectionKey:D.any,paginator:D.bool,first:D.number,rows:D.number,selectionMode:D.string,selectionKeys:D.any,metaKeySelection:D.bool,propagateSelectionUp:D.bool,propagateSelectionDown:D.bool,lazy:D.bool,rowClassName:D.func,emptyMessage:D.string,loading:D.bool,onExpand:D.func,onCollapse:D.func,onToggle:D.func,onRowClick:D.func,onSelect:D.func,onUnselect:D.func,onSelectionChange:D.func,onContextMenuSelectionChange:D.func,onContextMenu:D.func});var $=function(o){S(l,t);var n,r,i=(n=l,r=X(),function(){var e,t=w(n);if(r){var o=w(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return E(this,e)});function l(){return g(this,l),i.apply(this,arguments)}return v(l,[{key:"renderFooterCell",value:function(t,o){return e.createElement("td",{key:t.field||o,className:t.props.footerClassName||t.props.className,style:t.props.footerStyle||t.props.style,rowSpan:t.props.rowSpan,colSpan:t.props.colSpan},t.props.footer)}},{key:"renderFooterRow",value:function(t,o){var n=this,r=e.Children.toArray(t.props.children).map((function(e,t){return n.renderFooterCell(e,t)}));return e.createElement("tr",{key:o},r)}},{key:"renderColumnGroup",value:function(){var t=this;return e.Children.toArray(this.props.columnGroup.props.children).map((function(e,o){return t.renderFooterRow(e,o)}))}},{key:"renderColumns",value:function(t){var o=this;if(t){var n=t.map((function(e,t){return o.renderFooterCell(e,t)}));return e.createElement("tr",null,n)}return null}},{key:"hasFooter",value:function(){if(this.props.columnGroup)return!0;for(var e=0;e<this.props.columns.length;e++)if(this.props.columns[e].props.footer)return!0;return!1}},{key:"render",value:function(){var t=this.props.columnGroup?this.renderColumnGroup():this.renderColumns(this.props.columns);return this.hasFooter()?e.createElement("tfoot",{className:"p-treetable-tfoot"},t):null}}]),l}();function q(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}x($,"defaultProps",{columns:null,columnGroup:null}),x($,"propTypes",{columns:D.array,columnGroup:D.any});var J=function(r){S(a,t);var i,l,s=(i=a,l=q(),function(){var e,t=w(i);if(l){var o=w(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return E(this,e)});function a(e){var t;return g(this,a),(t=s.call(this,e)).onHeaderScroll=t.onHeaderScroll.bind(b(t)),t.onBodyScroll=t.onBodyScroll.bind(b(t)),t}return v(a,[{key:"componentDidMount",value:function(){if(this.setScrollHeight(),this.props.frozen)this.scrollBody.style.paddingBottom=o.calculateScrollbarWidth()+"px";else{var e=o.calculateScrollbarWidth();this.scrollHeaderBox.style.marginRight=e+"px",this.scrollFooterBox&&(this.scrollFooterBox.style.marginRight=e+"px")}}},{key:"componentDidUpdate",value:function(){this.setScrollHeight()}},{key:"setScrollHeight",value:function(){if(this.props.scrollHeight)if(-1!==this.props.scrollHeight.indexOf("%")){var e=this.findDataTableContainer(this.container);this.scrollBody.style.visibility="hidden",this.scrollBody.style.height="100px";var t=o.getOuterHeight(e),n=o.getOuterHeight(e.parentElement)*parseInt(this.props.scrollHeight,10)/100-(t-100);this.scrollBody.style.height="auto",this.scrollBody.style.maxHeight=n+"px",this.scrollBody.style.visibility="visible"}else this.scrollBody.style.maxHeight=this.props.scrollHeight}},{key:"findDataTableContainer",value:function(e){if(e){for(var t=e;t&&!o.hasClass(t,"p-treetable");)t=t.parentElement;return t}return null}},{key:"onHeaderScroll",value:function(){this.scrollHeader.scrollLeft=0}},{key:"onBodyScroll",value:function(){var e,t=this.container.previousElementSibling;t&&(e=o.findSingle(t,".p-treetable-scrollable-body")),this.scrollHeaderBox.style.marginLeft=-1*this.scrollBody.scrollLeft+"px",this.scrollFooterBox&&(this.scrollFooterBox.style.marginLeft=-1*this.scrollBody.scrollLeft+"px"),e&&(e.scrollTop=this.scrollBody.scrollTop)}},{key:"calculateRowHeight",value:function(){var e=o.findSingle(this.scrollTable,"tr:not(.p-treetable-emptymessage-row)");e&&(this.rowHeight=o.getOuterHeight(e))}},{key:"renderColGroup",value:function(){return this.props.columns&&this.props.columns.length?e.createElement("colgroup",{className:"p-treetable-scrollable-colgroup"},this.props.columns.map((function(t,o){return e.createElement("col",{key:t.field+"_"+o})}))):null}},{key:"render",value:function(){var t=this,o=n("p-treetable-scrollable-view",{"p-treetable-frozen-view":this.props.frozen,"p-treetable-unfrozen-view":!this.props.frozen&&this.props.frozenWidth}),r=this.props.frozen?this.props.frozenWidth:"calc(100% - "+this.props.frozenWidth+")",i=this.props.frozen?null:this.props.frozenWidth,l=this.renderColGroup(),s=!this.props.frozen&&this.props.scrollHeight?{overflowY:"scroll"}:null;return e.createElement("div",{className:o,style:{width:r,left:i},ref:function(e){t.container=e}},e.createElement("div",{className:"p-treetable-scrollable-header",ref:function(e){t.scrollHeader=e},onScroll:this.onHeaderScroll},e.createElement("div",{className:"p-treetable-scrollable-header-box",ref:function(e){t.scrollHeaderBox=e}},e.createElement("table",{className:"p-treetable-scrollable-header-table"},l,this.props.header))),e.createElement("div",{className:"p-treetable-scrollable-body",ref:function(e){t.scrollBody=e},style:s,onScroll:this.onBodyScroll},e.createElement("table",{ref:function(e){t.scrollTable=e},style:{top:"0"},className:"p-treetable-scrollable-body-table"},l,this.props.body)),e.createElement("div",{className:"p-treetable-scrollable-footer",ref:function(e){t.scrollFooter=e}},e.createElement("div",{className:"p-treetable-scrollable-footer-box",ref:function(e){t.scrollFooterBox=e}},e.createElement("table",{className:"p-treetable-scrollable-footer-table"},l,this.props.footer))))}}]),a}();function Y(e,t){var o="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!o){if(Array.isArray(e)||(o=Q(e))||t&&e&&"number"==typeof e.length){o&&(e=o);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,s=!1;return{s:function(){o=o.call(e)},n:function(){var e=o.next();return l=e.done,e},e:function(e){s=!0,i=e},f:function(){try{l||null==o.return||o.return()}finally{if(s)throw i}}}}function Q(e,t){if(e){if("string"==typeof e)return Z(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?Z(e,t):void 0}}function Z(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function ee(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function te(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(o),!0).forEach((function(t){x(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):ee(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function oe(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}x(J,"defaultProps",{header:null,body:null,footer:null,columns:null,frozen:null,frozenWidth:null,frozenBody:null}),x(J,"propTypes",{header:D.any,body:D.any,footer:D.any,columns:D.array,frozen:D.bool,frozenWidth:D.string,frozenBody:D.any});var ne=function(s){S(u,t);var a,p,c=(a=u,p=oe(),function(){var e,t=w(a);if(p){var o=w(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return E(this,e)});function u(e){var t;g(this,u);var o={};return(t=c.call(this,e)).props.onToggle||(t.state={expandedKeys:t.props.expandedKeys}),t.props.onPage||(o.first=e.first,o.rows=e.rows),t.props.onSort||(o.sortField=e.sortField,o.sortOrder=e.sortOrder,o.multiSortMeta=e.multiSortMeta),t.props.onFilter||(o.filters=e.filters),Object.keys(o).length&&(t.state=o),t.onToggle=t.onToggle.bind(b(t)),t.onPageChange=t.onPageChange.bind(b(t)),t.onSort=t.onSort.bind(b(t)),t.onFilter=t.onFilter.bind(b(t)),t.onColumnResizeStart=t.onColumnResizeStart.bind(b(t)),t.onColumnDragStart=t.onColumnDragStart.bind(b(t)),t.onColumnDragOver=t.onColumnDragOver.bind(b(t)),t.onColumnDragLeave=t.onColumnDragLeave.bind(b(t)),t.onColumnDrop=t.onColumnDrop.bind(b(t)),t}return v(u,[{key:"onToggle",value:function(e){this.props.onToggle?this.props.onToggle(e):this.setState({expandedKeys:e.value})}},{key:"onPageChange",value:function(e){this.props.onPage?this.props.onPage(e):this.setState({first:e.first,rows:e.rows})}},{key:"onSort",value:function(e){var t,o,n=e.sortField,r=this.props.defaultSortOrder;if(this.columnSortable=e.sortable,this.columnSortFunction=e.sortFunction,this.columnField=e.sortField,"multiple"===this.props.sortMode){var i=e.originalEvent.metaKey||e.originalEvent.ctrlKey;if((t=this.getMultiSortMeta())&&t instanceof Array){var l=t.find((function(e){return e.field===n}));r=l?this.getCalculatedSortOrder(l.order):r}var s={field:n,order:r};r?(t&&i||(t=[]),this.addSortMeta(s,t)):this.props.removableSort&&t&&this.removeSortMeta(s,t),o={multiSortMeta:t}}else r=this.getSortField()===n?this.getCalculatedSortOrder(this.getSortOrder()):r,this.props.removableSort&&(n=r?n:null),o={sortField:n,sortOrder:r};this.props.onSort?this.props.onSort(o):(o.first=0,this.setState(o))}},{key:"getCalculatedSortOrder",value:function(e){return this.props.removableSort?this.props.defaultSortOrder===e?-1*e:0:-1*e}},{key:"addSortMeta",value:function(e,t){for(var o=-1,n=0;n<t.length;n++)if(t[n].field===e.field){o=n;break}o>=0?t[o]=e:t.push(e)}},{key:"removeSortMeta",value:function(e,t){for(var o=-1,n=0;n<t.length;n++)if(t[n].field===e.field){o=n;break}o>=0&&t.splice(o,1),t=t.length>0?t:null}},{key:"sortSingle",value:function(e){return this.sortNodes(e)}},{key:"sortNodes",value:function(e){var t=this,o=y(e);if(this.columnSortable&&"custom"===this.columnSortable&&this.columnSortFunction)o=this.columnSortFunction({field:this.getSortField(),order:this.getSortOrder()});else{o.sort((function(e,o){var n=t.getSortField(),i=r.resolveFieldData(e.data,n),l=r.resolveFieldData(o.data,n),s=null;return s=null==i&&null!=l?-1:null!=i&&null==l?1:null==i&&null==l?0:"string"==typeof i&&"string"==typeof l?i.localeCompare(l,void 0,{numeric:!0}):i<l?-1:i>l?1:0,t.getSortOrder()*s}));for(var n=0;n<o.length;n++)o[n].children&&o[n].children.length&&(o[n].children=this.sortNodes(o[n].children))}return o}},{key:"sortMultiple",value:function(e){var t=this.getMultiSortMeta();return t?this.sortMultipleNodes(e,t):e}},{key:"sortMultipleNodes",value:function(e,t){var o=this,n=y(e);n.sort((function(e,n){return o.multisortField(e,n,t,0)}));for(var r=0;r<n.length;r++)n[r].children&&n[r].children.length&&(n[r].children=this.sortMultipleNodes(n[r].children,t));return n}},{key:"multisortField",value:function(e,t,o,n){var i=r.resolveFieldData(e.data,o[n].field),l=r.resolveFieldData(t.data,o[n].field),s=null;if(null==i&&null!=l)s=-1;else if(null!=i&&null==l)s=1;else if(null==i&&null==l)s=0;else{if(i===l)return o.length-1>n?this.multisortField(e,t,o,n+1):0;if(("string"==typeof i||i instanceof String)&&("string"==typeof l||l instanceof String))return o[n].order*i.localeCompare(l,void 0,{numeric:!0});s=i<l?-1:1}return o[n].order*s}},{key:"filter",value:function(e,t,o){this.onFilter({value:e,field:t,matchMode:o})}},{key:"onFilter",value:function(e){var t=this.getFilters(),o=t?te({},t):{};this.isFilterBlank(e.value)?o[e.field]&&delete o[e.field]:o[e.field]={value:e.value,matchMode:e.matchMode},this.props.onFilter?this.props.onFilter({filters:o}):this.setState({first:0,filters:o})}},{key:"hasFilter",value:function(){var e=this.getFilters();return e&&Object.keys(e).length>0}},{key:"isFilterBlank",value:function(e){return null==e||("string"==typeof e&&0===e.trim().length||e instanceof Array&&0===e.length)}},{key:"onColumnResizeStart",value:function(e){var t=o.getOffset(this.container).left;this.resizeColumn=e.columnEl,this.resizeColumnProps=e.column,this.columnResizing=!0,this.lastResizerHelperX=e.originalEvent.pageX-t+this.container.scrollLeft,this.bindColumnResizeEvents()}},{key:"onColumnResize",value:function(e){var t=o.getOffset(this.container).left;o.addClass(this.container,"p-unselectable-text"),this.resizerHelper.style.height=this.container.offsetHeight+"px",this.resizerHelper.style.top="0px",this.resizerHelper.style.left=e.pageX-t+this.container.scrollLeft+"px",this.resizerHelper.style.display="block"}},{key:"onColumnResizeEnd",value:function(e){var t=this.resizerHelper.offsetLeft-this.lastResizerHelperX,n=this.resizeColumn.offsetWidth,r=n+t;if(n+t>parseInt(this.resizeColumn.style.minWidth||15,10)){if("fit"===this.props.columnResizeMode){var i=this.resizeColumn.nextElementSibling,l=i.offsetWidth-t;if(r>15&&l>15)if(this.props.scrollable){var s=this.findParentScrollableView(this.resizeColumn),a=o.findSingle(s,"table.p-treetable-scrollable-body-table"),p=o.findSingle(s,"table.p-treetable-scrollable-header-table"),c=o.findSingle(s,"table.p-treetable-scrollable-footer-table"),u=o.index(this.resizeColumn);this.resizeColGroup(p,u,r,l),this.resizeColGroup(a,u,r,l),this.resizeColGroup(c,u,r,l)}else this.resizeColumn.style.width=r+"px",i&&(i.style.width=l+"px")}else if("expand"===this.props.columnResizeMode)if(this.props.scrollable){var h=this.findParentScrollableView(this.resizeColumn),d=o.findSingle(h,"table.p-treetable-scrollable-body-table"),f=o.findSingle(h,"table.p-treetable-scrollable-header-table"),y=o.findSingle(h,"table.p-treetable-scrollable-footer-table");d.style.width=d.offsetWidth+t+"px",f.style.width=f.offsetWidth+t+"px",y&&(y.style.width=f.offsetWidth+t+"px");var g=o.index(this.resizeColumn);this.resizeColGroup(f,g,r,null),this.resizeColGroup(d,g,r,null),this.resizeColGroup(y,g,r,null)}else this.table.style.width=this.table.offsetWidth+t+"px",this.resizeColumn.style.width=r+"px";this.props.onColumnResizeEnd&&this.props.onColumnResizeEnd({element:this.resizeColumn,column:this.resizeColumnProps,delta:t})}this.resizerHelper.style.display="none",this.resizeColumn=null,this.resizeColumnProps=null,o.removeClass(this.container,"p-unselectable-text"),this.unbindColumnResizeEvents()}},{key:"findParentScrollableView",value:function(e){if(e){for(var t=e.parentElement;t&&!o.hasClass(t,"p-treetable-scrollable-view");)t=t.parentElement;return t}return null}},{key:"resizeColGroup",value:function(e,t,o,n){if(e){var r="COLGROUP"===e.children[0].nodeName?e.children[0]:null;if(!r)throw new Error("Scrollable tables require a colgroup to support resizable columns");var i=r.children[t],l=i.nextElementSibling;i.style.width=o+"px",l&&n&&(l.style.width=n+"px")}}},{key:"bindColumnResizeEvents",value:function(){var e=this;this.documentColumnResizeListener=document.addEventListener("mousemove",(function(t){e.columnResizing&&e.onColumnResize(t)})),this.documentColumnResizeEndListener=document.addEventListener("mouseup",(function(t){e.columnResizing&&(e.columnResizing=!1,e.onColumnResizeEnd(t))}))}},{key:"unbindColumnResizeEvents",value:function(){document.removeEventListener("document",this.documentColumnResizeListener),document.removeEventListener("document",this.documentColumnResizeEndListener)}},{key:"onColumnDragStart",value:function(e){var t=e.originalEvent,n=e.column;this.columnResizing?t.preventDefault():(this.iconWidth=o.getHiddenElementOuterWidth(this.reorderIndicatorUp),this.iconHeight=o.getHiddenElementOuterHeight(this.reorderIndicatorUp),this.draggedColumnEl=this.findParentHeader(t.currentTarget),this.draggedColumn=n,t.dataTransfer.setData("text","b"))}},{key:"onColumnDragOver",value:function(e){var t=e.originalEvent,n=this.findParentHeader(t.currentTarget);if(this.props.reorderableColumns&&this.draggedColumnEl&&n){t.preventDefault();var r=o.getOffset(this.container),i=o.getOffset(n);if(this.draggedColumnEl!==n){var l=i.left-r.left,s=i.left+n.offsetWidth/2;this.reorderIndicatorUp.style.top=i.top-r.top-(this.iconHeight-1)+"px",this.reorderIndicatorDown.style.top=i.top-r.top+n.offsetHeight+"px",t.pageX>s?(this.reorderIndicatorUp.style.left=l+n.offsetWidth-Math.ceil(this.iconWidth/2)+"px",this.reorderIndicatorDown.style.left=l+n.offsetWidth-Math.ceil(this.iconWidth/2)+"px",this.dropPosition=1):(this.reorderIndicatorUp.style.left=l-Math.ceil(this.iconWidth/2)+"px",this.reorderIndicatorDown.style.left=l-Math.ceil(this.iconWidth/2)+"px",this.dropPosition=-1),this.reorderIndicatorUp.style.display="block",this.reorderIndicatorDown.style.display="block"}}}},{key:"onColumnDragLeave",value:function(e){this.props.reorderableColumns&&this.draggedColumnEl&&(e.originalEvent.preventDefault(),this.reorderIndicatorUp.style.display="none",this.reorderIndicatorDown.style.display="none")}},{key:"onColumnDrop",value:function(t){var n=this,i=t.originalEvent,l=t.column;if(i.preventDefault(),this.draggedColumnEl){var s=o.index(this.draggedColumnEl),a=o.index(this.findParentHeader(i.currentTarget)),p=s!==a;if(p&&(a-s==1&&-1===this.dropPosition||s-a==1&&1===this.dropPosition)&&(p=!1),p){var c=this.state.columnOrder?this.getColumns():e.Children.toArray(this.props.children),u=function(e,t){return r.equals(e,t,e.props.columnKey||t.props.columnKey?"props.columnKey":"props.field")},h=c.findIndex((function(e){return u(e,n.draggedColumn)})),d=c.findIndex((function(e){return u(e,l)}));d<h&&1===this.dropPosition&&d++,d>h&&-1===this.dropPosition&&d--,r.reorderArray(c,h,d);var f,y=[],g=Y(c);try{for(g.s();!(f=g.n()).done;){var m=f.value;y.push(m.props.columnKey||m.props.field)}}catch(e){g.e(e)}finally{g.f()}this.setState({columnOrder:y}),this.props.onColReorder&&this.props.onColReorder({dragIndex:h,dropIndex:d,columns:c})}this.reorderIndicatorUp.style.display="none",this.reorderIndicatorDown.style.display="none",this.draggedColumnEl.draggable=!1,this.draggedColumnEl=null,this.dropPosition=null}}},{key:"findParentHeader",value:function(e){if("TH"===e.nodeName)return e;for(var t=e.parentElement;"TH"!==t.nodeName&&(t=t.parentElement););return t}},{key:"getExpandedKeys",value:function(){return this.props.onToggle?this.props.expandedKeys:this.state.expandedKeys}},{key:"getFirst",value:function(){return this.props.onPage?this.props.first:this.state.first}},{key:"getRows",value:function(){return this.props.onPage?this.props.rows:this.state.rows}},{key:"getSortField",value:function(){return this.props.onSort?this.props.sortField:this.state.sortField}},{key:"getSortOrder",value:function(){return this.props.onSort?this.props.sortOrder:this.state.sortOrder}},{key:"getMultiSortMeta",value:function(){return this.props.onSort?this.props.multiSortMeta:this.state.multiSortMeta}},{key:"getFilters",value:function(){return this.props.onFilter?this.props.filters:this.state.filters}},{key:"findColumnByKey",value:function(e,t){if(e&&e.length)for(var o=0;o<e.length;o++){var n=e[o];if(n.props.columnKey===t||n.props.field===t)return n}return null}},{key:"getColumns",value:function(){var t=e.Children.toArray(this.props.children);if(t&&t.length){if(this.props.reorderableColumns&&this.state.columnOrder){var o,n=[],r=Y(this.state.columnOrder);try{for(r.s();!(o=r.n()).done;){var i=this.findColumnByKey(t,o.value);i&&n.push(i)}}catch(e){r.e(e)}finally{r.f()}return[].concat(n,y(t.filter((function(e){return n.indexOf(e)<0}))))}return t}return null}},{key:"getTotalRecords",value:function(e){return this.props.lazy?this.props.totalRecords:e?e.length:0}},{key:"isSingleSelectionMode",value:function(){return this.props.selectionMode&&"single"===this.props.selectionMode}},{key:"isMultipleSelectionMode",value:function(){return this.props.selectionMode&&"multiple"===this.props.selectionMode}},{key:"isRowSelectionMode",value:function(){return this.isSingleSelectionMode()||this.isMultipleSelectionMode()}},{key:"getFrozenColumns",value:function(e){var t,o=null,n=Y(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.props.frozen&&(o=o||[]).push(r)}}catch(e){n.e(e)}finally{n.f()}return o}},{key:"getScrollableColumns",value:function(e){var t,o=null,n=Y(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.props.frozen||(o=o||[]).push(r)}}catch(e){n.e(e)}finally{n.f()}return o}},{key:"filterLocal",value:function(t){var o,n=[],r=this.getFilters(),l=e.Children.toArray(this.props.children),s="strict"===this.props.filterMode,a=Y(t);try{for(a.s();!(o=a.n()).done;){for(var p=o.value,c=te({},p),u=!0,h=!1,d=0;d<l.length;d++){var f=l[d],y=r?r[f.props.field]:null,g=f.props.field,m=void 0;if(y){var v=y.matchMode||f.props.filterMatchMode;if(m={filterField:g,filterValue:y.value,filterConstraint:"custom"===v?f.props.filterFunction:i[v],isStrictMode:s,options:{rowData:p,filters:r,props:this.props,column:{filterMeta:y,filterField:g,props:f.props}}},(!s||this.findFilteredNodes(c,m)||this.isFilterMatched(c,m))&&(s||this.isFilterMatched(c,m)||this.findFilteredNodes(c,m))||(u=!1),!u)break}if(this.props.globalFilter&&!h){var b=te({},c);m={filterField:g,filterValue:this.props.globalFilter,filterConstraint:i.contains,isStrictMode:s},(s&&(this.findFilteredNodes(b,m)||this.isFilterMatched(b,m))||!s&&(this.isFilterMatched(b,m)||this.findFilteredNodes(b,m)))&&(h=!0,c=b)}}var C=u;this.props.globalFilter&&(C=u&&h),C&&n.push(c)}}catch(e){a.e(e)}finally{a.f()}return n}},{key:"findFilteredNodes",value:function(e,t){if(e){var o=!1;if(e.children){var n=y(e.children);e.children=[];var r,i=Y(n);try{for(i.s();!(r=i.n()).done;){var l=te({},r.value);this.isFilterMatched(l,t)&&(o=!0,e.children.push(l))}}catch(e){i.e(e)}finally{i.f()}}if(o)return!0}}},{key:"isFilterMatched",value:function(e,t){var o=t.filterField,n=t.filterValue,i=t.filterConstraint,l=t.isStrictMode,s=t.options,a=!1;return i(r.resolveFieldData(e.data,o),n,this.props.filterLocale,s)&&(a=!0),(!a||l&&!this.isNodeLeaf(e))&&(a=this.findFilteredNodes(e,{filterField:o,filterValue:n,filterConstraint:i,isStrictMode:l})||a),a}},{key:"isNodeLeaf",value:function(e){return!1!==e.leaf&&!(e.children&&e.children.length)}},{key:"processValue",value:function(){var e=this.props.value;if(!this.props.lazy&&e&&e.length){(this.getSortField()||this.getMultiSortMeta())&&("single"===this.props.sortMode?e=this.sortSingle(e):"multiple"===this.props.sortMode&&(e=this.sortMultiple(e)));var t=this.getFilters();(t||this.props.globalFilter)&&(e=this.filterLocal(e,t))}return e}},{key:"createTableHeader",value:function(t,o){return e.createElement(K,{columns:t,columnGroup:o,tabIndex:this.props.tabIndex,onSort:this.onSort,sortField:this.getSortField(),sortOrder:this.getSortOrder(),multiSortMeta:this.getMultiSortMeta(),resizableColumns:this.props.resizableColumns,onResizeStart:this.onColumnResizeStart,reorderableColumns:this.props.reorderableColumns,onDragStart:this.onColumnDragStart,onDragOver:this.onColumnDragOver,onDragLeave:this.onColumnDragLeave,onDrop:this.onColumnDrop,onFilter:this.onFilter,filters:this.getFilters(),filterDelay:this.props.filterDelay})}},{key:"createTableFooter",value:function(t,o){return e.createElement($,{columns:t,columnGroup:o})}},{key:"createTableBody",value:function(t,o){return e.createElement(_,{value:t,columns:o,expandedKeys:this.getExpandedKeys(),selectOnEdit:this.props.selectOnEdit,onToggle:this.onToggle,onExpand:this.props.onExpand,onCollapse:this.props.onCollapse,paginator:this.props.paginator,first:this.getFirst(),rows:this.getRows(),selectionMode:this.props.selectionMode,selectionKeys:this.props.selectionKeys,onSelectionChange:this.props.onSelectionChange,metaKeySelection:this.props.metaKeySelection,onRowClick:this.props.onRowClick,onSelect:this.props.onSelect,onUnselect:this.props.onUnselect,propagateSelectionUp:this.props.propagateSelectionUp,propagateSelectionDown:this.props.propagateSelectionDown,lazy:this.props.lazy,rowClassName:this.props.rowClassName,emptyMessage:this.props.emptyMessage,loading:this.props.loading,contextMenuSelectionKey:this.props.contextMenuSelectionKey,onContextMenuSelectionChange:this.props.onContextMenuSelectionChange,onContextMenu:this.props.onContextMenu})}},{key:"createPaginator",value:function(t,o){var r=n("p-paginator-"+t,this.props.paginatorClassName);return e.createElement(l,{first:this.getFirst(),rows:this.getRows(),pageLinkSize:this.props.pageLinkSize,className:r,onPageChange:this.onPageChange,template:this.props.paginatorTemplate,totalRecords:o,rowsPerPageOptions:this.props.rowsPerPageOptions,currentPageReportTemplate:this.props.currentPageReportTemplate,leftContent:this.props.paginatorLeft,rightContent:this.props.paginatorRight,alwaysShow:this.props.alwaysShowPaginator,dropdownAppendTo:this.props.paginatorDropdownAppendTo})}},{key:"createScrollableView",value:function(t,o,n,r,i){var l=this.createTableHeader(o,r),s=this.createTableFooter(o,i),a=this.createTableBody(t,o);return e.createElement(J,{columns:o,header:l,body:a,footer:s,scrollHeight:this.props.scrollHeight,frozen:n,frozenWidth:this.props.frozenWidth})}},{key:"renderScrollableTable",value:function(t){var o,n,r=this.getColumns(),i=this.getFrozenColumns(r),l=i?this.getScrollableColumns(r):r;return i&&(o=this.createScrollableView(t,i,!0,this.props.frozenHeaderColumnGroup,this.props.frozenFooterColumnGroup)),n=this.createScrollableView(t,l,!1,this.props.headerColumnGroup,this.props.footerColumnGroup),e.createElement("div",{className:"p-treetable-scrollable-wrapper"},o,n)}},{key:"renderRegularTable",value:function(t){var o=this,n=this.getColumns(),r=this.createTableHeader(n,this.props.headerColumnGroup),i=this.createTableFooter(n,this.props.footerColumnGroup),l=this.createTableBody(t,n);return e.createElement("div",{className:"p-treetable-wrapper"},e.createElement("table",{style:this.props.tableStyle,className:this.props.tableClassName,ref:function(e){return o.table=e}},r,i,l))}},{key:"renderTable",value:function(e){return this.props.scrollable?this.renderScrollableTable(e):this.renderRegularTable(e)}},{key:"renderLoader",value:function(){if(this.props.loading){var t=n("p-treetable-loading-icon pi-spin",this.props.loadingIcon);return e.createElement("div",{className:"p-treetable-loading"},e.createElement("div",{className:"p-treetable-loading-overlay p-component-overlay"},e.createElement("i",{className:t})))}return null}},{key:"render",value:function(){var t=this,o=this.processValue(),r=n("p-treetable p-component",{"p-treetable-hoverable-rows":this.isRowSelectionMode(),"p-treetable-resizable":this.props.resizableColumns,"p-treetable-resizable-fit":this.props.resizableColumns&&"fit"===this.props.columnResizeMode,"p-treetable-auto-layout":this.props.autoLayout,"p-treetable-striped":this.props.stripedRows,"p-treetable-gridlines":this.props.showGridlines},this.props.className),i=this.renderTable(o),l=this.getTotalRecords(o),s=this.props.header&&e.createElement("div",{className:"p-treetable-header"},this.props.header),a=this.props.footer&&e.createElement("div",{className:"p-treetable-footer"},this.props.footer),p=this.props.paginator&&"bottom"!==this.props.paginatorPosition&&this.createPaginator("top",l),c=this.props.paginator&&"top"!==this.props.paginatorPosition&&this.createPaginator("bottom",l),u=this.renderLoader();return e.createElement("div",{id:this.props.id,className:r,style:this.props.style,ref:function(e){return t.container=e},"data-scrollselectors":".p-treetable-scrollable-body"},u,s,p,i,c,a,this.props.resizableColumns&&e.createElement("div",{ref:function(e){t.resizerHelper=e},className:"p-column-resizer-helper",style:{display:"none"}}),this.props.reorderableColumns&&e.createElement("span",{ref:function(e){return t.reorderIndicatorUp=e},className:"pi pi-arrow-down p-datatable-reorder-indicator-up",style:{position:"absolute",display:"none"}}),this.props.reorderableColumns&&e.createElement("span",{ref:function(e){return t.reorderIndicatorDown=e},className:"pi pi-arrow-up p-datatable-reorder-indicator-down",style:{position:"absolute",display:"none"}}))}}]),u}();x(ne,"defaultProps",{id:null,value:null,header:null,footer:null,style:null,className:null,tableStyle:null,tableClassName:null,expandedKeys:null,paginator:!1,paginatorPosition:"bottom",alwaysShowPaginator:!0,paginatorClassName:null,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown",paginatorLeft:null,paginatorRight:null,paginatorDropdownAppendTo:null,pageLinkSize:5,rowsPerPageOptions:null,currentPageReportTemplate:"({currentPage} of {totalPages})",first:null,rows:null,totalRecords:null,lazy:!1,sortField:null,sortOrder:null,multiSortMeta:null,sortMode:"single",defaultSortOrder:1,removableSort:!1,selectionMode:null,selectionKeys:null,contextMenuSelectionKey:null,metaKeySelection:!0,selectOnEdit:!0,propagateSelectionUp:!0,propagateSelectionDown:!0,autoLayout:!1,rowClassName:null,loading:!1,loadingIcon:"pi pi-spinner",tabIndex:0,scrollable:!1,scrollHeight:null,reorderableColumns:!1,headerColumnGroup:null,footerColumnGroup:null,frozenHeaderColumnGroup:null,frozenFooterColumnGroup:null,frozenWidth:null,resizableColumns:!1,columnResizeMode:"fit",emptyMessage:"No records found",filters:null,globalFilter:null,filterMode:"lenient",filterDelay:300,filterLocale:void 0,showGridlines:!1,stripedRows:!1,onFilter:null,onExpand:null,onCollapse:null,onToggle:null,onPage:null,onSort:null,onSelect:null,onUnselect:null,onRowClick:null,onSelectionChange:null,onContextMenuSelectionChange:null,onColumnResizeEnd:null,onColReorder:null,onContextMenu:null}),x(ne,"propTypes",{id:D.string,value:D.any,header:D.any,footer:D.any,style:D.object,className:D.string,tableStyle:D.any,tableClassName:D.string,expandedKeys:D.object,paginator:D.bool,paginatorPosition:D.string,alwaysShowPaginator:D.bool,paginatorClassName:D.string,paginatorTemplate:D.oneOfType([D.string,D.object]),paginatorLeft:D.any,paginatorRight:D.any,paginatorDropdownAppendTo:D.oneOfType([D.object,D.string]),pageLinkSize:D.number,rowsPerPageOptions:D.array,currentPageReportTemplate:D.string,first:D.number,rows:D.number,totalRecords:D.number,lazy:D.bool,sortField:D.string,sortOrder:D.number,multiSortMeta:D.array,sortMode:D.string,defaultSortOrder:D.number,removableSort:D.bool,selectionMode:D.string,selectionKeys:D.any,contextMenuSelectionKey:D.any,metaKeySelection:D.bool,selectOnEdit:D.bool,propagateSelectionUp:D.bool,propagateSelectionDown:D.bool,autoLayout:D.bool,rowClassName:D.func,loading:D.bool,loadingIcon:D.string,tabIndex:D.number,scrollable:D.bool,scrollHeight:D.string,reorderableColumns:D.bool,headerColumnGroup:D.any,footerColumnGroup:D.any,frozenHeaderColumnGroup:D.any,frozenFooterColumnGroup:D.any,frozenWidth:D.string,resizableColumns:D.bool,columnResizeMode:D.string,emptyMessage:D.string,filters:D.object,globalFilter:D.any,filterMode:D.string,filterDelay:D.number,filterLocale:D.string,showGridlines:D.bool,stripedRows:D.bool,onFilter:D.func,onExpand:D.func,onCollapse:D.func,onToggle:D.func,onPage:D.func,onSort:D.func,onSelect:D.func,onUnselect:D.func,onRowClick:D.func,onSelectionChange:D.func,onContextMenuSelectionChange:D.func,onColumnResizeEnd:D.func,onColReorder:D.func,onContextMenu:D.func});export{ne as TreeTable};
